<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 4.1.3.2 (Linux)">
	<META NAME="CREATED" CONTENT="20140406;3740809241">
	<META NAME="CHANGED" CONTENT="20140407;110535034758480">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 2cm }
		P { margin-bottom: 0.21cm }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
<BODY LANG="ru-RU" DIR="LTR">
<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Структура
драйвера</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Драйвер
состоит из:</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>4-х
	логических частей:</FONT></FONT></P>
</UL>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Символьное
	устройство;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Работа
	с процессами;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Обработчик
	команд;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Инициализация
	самого драйвера;</FONT></FONT></P>
</UL>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>6-и
	файлов:</FONT></FONT></P>
</UL>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>affl_char_dev.h;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>affl_char_dev.c;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>affl_process.h;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>affl_procecc.c;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>affl_main.h;</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>afffl_main.c;</FONT></FONT></P>
</UL>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>26
	функций</FONT></FONT></P>
</UL>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#333333"><U><B>affl_open</B></U></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	inode *i, </FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	file *f);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_close</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	inode *i, </FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	file *f);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#005032">ssize_t</FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_read</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	file *f, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
	__user *buf, </FONT><FONT COLOR="#005032">size_t</FONT><FONT COLOR="#000000">
	len, </FONT><FONT COLOR="#005032">loff_t</FONT><FONT COLOR="#000000">
	*off);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#333333"><U>ssize_t</U></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_write</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
	file *f, </FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
	__user *buf, </FONT><FONT COLOR="#005032">size_t</FONT><FONT COLOR="#000000">
	len, </FONT><FONT COLOR="#005032">loff_t</FONT><FONT COLOR="#000000">
	*off);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_init_char_dev</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	file_name, </FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	device_name);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_clean_char_dev</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_init_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_clean_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>unsigned</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_handle</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	input, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	user_buf);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">*
	</FONT><FONT COLOR="#000000"><B>find_sym</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
	*sym);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_proc_name</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	input, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">**
	proc_name);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_proc_PID</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	input, </FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">*
	PID);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_task</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_quantity_tasks</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_black_list</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	user_buf);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_get_info_for_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	pid, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	user_buf);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>unsigned</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_view_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	user_buf);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_kill_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	name, </FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	PID);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_from_name_to_pid</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	name);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_exist</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	user_buf);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_bl_print</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_bl_add</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	arg);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_bl_rm</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	arg);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_bl_cmp</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	arg);</FONT></FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#000000"><B>affl_add_list_process_mass</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
	</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	proc_name, </FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
	PID);</FONT></FONT></FONT></P>
	<P ALIGN=CENTER STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4>Описание
	функций</FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>	int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_open</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#333333"><U>inode</U></FONT><FONT COLOR="#000000">
*i, </FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
file *f):</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Параметры
i и f передаются системой.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Это
перегрузка системной функции для файла
символьного устройства, при открытии
файла устройства будет вызываться эта
функция и инкрементировать счетчик
открытий.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#7f0055"><B>	int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_close</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
inode *i, </FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
file *f);</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Параметры
i и f передаются системой.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Это
перегрузка системной функции для файла
символьного устройства, при закрытии
файла устройства будет вызываться эта
функция и декркментировать счетчик
открытий.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#005032">	ssize_t</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_read</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
file *f, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
__user *buf, </FONT><FONT COLOR="#005032">size_t</FONT><FONT COLOR="#000000">
len, </FONT><FONT COLOR="#005032">loff_t</FONT><FONT COLOR="#000000">
	*off).</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Все
входные параметры передаются системой,
возвращает количество считанных
символов.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Это
перегрузка системной функции для файла
символьного устройства, копирует
содержимое buf в глобальную переменную
ядра </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
affl_kernel_buf[255] и передает указатель на
копию buf, функции affl_handle(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
input, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
user_buf), также в эту функцию передается
сам buf для возможности записи в файл из
affl_handle(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
input, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
user_buf).</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#333333"><SPAN STYLE="text-decoration: none">	</SPAN></FONT><FONT COLOR="#333333"><U>ssize_t</U></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_write</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>struct</B></FONT><FONT COLOR="#000000">
file *f, </FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">
__user *buf, </FONT><FONT COLOR="#005032">size_t</FONT><FONT COLOR="#000000">
len, 	</FONT><FONT COLOR="#005032">loff_t</FONT><FONT COLOR="#000000">
*off)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Все
входные параметры передаются системой,
возвращает количество считанных
символов.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Это
перегрузка системной функции для файла
символьного устройства, копирует
содержимое переменной buf пользовательского
пространства в переменную ядерного
пространства, также копирует количество
записанных символов в глобальную
переменную </FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
affl_size.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><B>	</B></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_init_char_dev</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
file_name, </FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
	device_name)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">В
параметр file_name передается имя файла
смивольного устройства, файл будет
находиться в директории /dev/, в параметр
device_name передаеться имя регестрируемого
символьного устройства, при успешном
завершении функция возвращает 0, при не
удачном -1.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_clean_char_dev</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_char_dev.c, объявление лежит
в файле affl_char_dev.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Функция
разрушает символьное устройство и
удаляет файл устройства.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_init_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Функция
инициализирует указатели на функции
системных вызовов, адресами системных
вызовов, также, функция производит
подмену </FONT><FONT COLOR="#000000">адреса </FONT><FONT COLOR="#000000">системного
вызова sys_execve </FONT><FONT COLOR="#000000">в таблице
системных вызовов</FONT><FONT COLOR="#000000">.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_clean_process</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Функция
записывает в таблицу системных вызовов
старый адрес sys_execve.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>unsigned</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#000000"><B>affl_handle</B></FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
input, </FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000">*
user_buf)</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">	</FONT><FONT COLOR="#000000">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000">Ф</FONT><FONT COLOR="#000000">ункция
обрабатывает команды, поступившие в
файл устройства. </FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Вызов
этой функции производится из функции
</SPAN></FONT><FONT COLOR="#000000"><B>affl_read</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">.
В input передается содержимое файла
символьного устройства, а в user_buf
передается адрес буфера из пользовательского
пространства, для возможности записи
в файл из пространства ядра. Возвращаемое
значение возвращает количество
передаваемых символов в  user_buf.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
</SPAN></FONT><FONT COLOR="#000000"><B>find_sym</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
*sym)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает название системного вызова
и в случае усеха — возвращает адрес
системного вызова, иначе -озващает NULL.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_proc_name</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
input, </SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">**
proc_name)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает содержимое файла символьного
устройства и адрес строки </SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">proc_name</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">.
После отработки функция пишет в proc_name
имя процесса</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(функция
не проверяет существования такого
процесса)</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">,
</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">в
случае успеха возвращает 0, в противном
случае -1.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_proc_PID</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
input, </SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
PID)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает содержимое файла символьного
устройства и адрес переменной PID. В
случае, если полученный pid из строки
input существует, функция записывает
полученный pid в переменную PID и функция
возвращает 0, если полученный pid равен
-1, в переменную PID записываеться -1 и
функция возвращает 0, в противном случае
в PID записываеться 0 и функция возвращает
-1.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	
</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_task</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
заполняет глобальную переменную массива
структур, которая содержит имя процесса
и pid процесса.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_quantity_tasks</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
возвращает количество процессов в
системе.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_black_list</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
user_buf)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает указатель на буффер
пользовательского пространства и
возвращает количество записанных
символов в  user_buf. Функция записывает в
содержимое черного списа.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_get_info_for_process</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
pid, </SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
user_buf)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Функция
принимает pid, и указатель на буффер
пользовательского пространства,
возвращает количество записанных
символов в  user_buf. Если pid существует
функция пишет в user_buf имя процесса, pid,
полную командную строку, количество
используемых ресурсов и сами ресурсы
(файлы, pipes, socets). Если pid не существует,
функция пишет в user_buf «-1»;</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>unsigned</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_view_process</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
user_buf)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Функция
пишет в пользовательский буффер pid, имя
всех процессов, в первой строке
указываеться количество процессов.
Возвращает количество записанных
символов в  user_buf.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_kill_process</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
name, </SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
PID)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Функция
принимает имя процесса и PID, причем PID
может быть как валидным так и иметь
значение «-1». В первом случае убиваеться
процесс имеющий такой PID и не имеет
значения пфраметр name, во втором случае
убиваються все процессы имеющие имя
name. В успешном случае функция возвращает
0, в противном случае -1;</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_from_name_to_pid</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
name)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает строку и если есть процесс с
таким именем — функция возвращает
валидный pid, иначе возвращает 0.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_exist</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
user_buf)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Е</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">сли
файл существует и привязан к символьному
устройству, то при вызове этой функции
туда будет записан «0». Возвращает
количество записанных символов в буффер
пользовательского пространства..</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_bl_print</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">П</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ри
изменении черного списка функция
печатает в лог ядра черный список.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_bl_add</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
arg)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает строку и добавляет её в черный
список. В успешном случае возвращает
«0», если список переполнен, функция
возвращает «-2», если такая строка уже
существует черном списке, функция верне
«-1».</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_bl_rm</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
arg)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает строку и если есть такая
строка в черном списке — строка удаляеться
из черного списка и функция возвращает
«0», в противном случае функция возвращает
«-1».</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_bl_cmp</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
arg)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
принимает строку и сравнивает её с
черным списком. В успешном случае
возвращает «0» , в противном «-1».</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	</SPAN></FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#000000"><B>affl_add_list_process_mass</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">(</SPAN></FONT><FONT COLOR="#7f0055"><B>const</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT COLOR="#7f0055"><B>char</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">*
proc_name, </SPAN></FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">
PID)</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">	Определение
лежит в файле affl_process.c, объявление лежит
в файле affl_process.h.</SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0cm"><FONT FACE="Ubuntu"><FONT SIZE=4><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">Ф</SPAN></FONT><FONT COLOR="#000000"><SPAN STYLE="font-weight: normal">ункция
добавляет в массив структур имя процесса
и PiD.</SPAN></FONT></FONT></FONT></P>
</BODY>
</HTML>